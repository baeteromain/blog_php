{% extends 'layouts/default.twig' %}

{% block title %}
    <title>Liste des utilisateur</title>
{% endblock %}

{% block content %}

<main class="mw8 pa3 center flex flex-column min-vh-100 main_admin">
    <h1 class="nes pv2 tc">Gestion du blog</h1>
    <div class="nes dt center ml2-l mt6-l sidenav fixed-l z-1 top-1 left-0 overflow-x-hidden pa3 bg-near-black f6 no-underline  ">
        <a class="db-l pa2 link white hover-blue " href="/admin/users">Utilisateurs</a>
        <hr class="bt-1-l dn-m mv2">
        <a class="db-l pa2 link white hover-blue" href="/admin/posts">Articles</a>
        <hr class="bt-1-l dn-m mv2">
        <a class="db-l pa2 link white hover-blue" href="/admin/comments">Catégories</a>
        <hr class="bt-1-l dn-m mv2">
        <a class="db-l pa2 link white hover-blue" href="/admin/comments">Commentaires</a>
    </div>
    <section>
        <h3 class="underline ">Liste des utilisateurs</h3>
        
        <table class="w-100 collapse ph2">
            <thead>
                <tr class="bb b--silver">
                    <th class="tl pv3 ph2">id</th>
                    <th class="tc pv3">Nom d'utilisateur</th>
                    <th class="tc pv3">Email</th>
                    <th class="tc pv3">Role</th>
                    <th class="tc pv3">Administration</th>

                </tr>
            </thead>
            <tbody>
            {% for user in users %}
                <tr class="bb b--moon-gray hover-bg-lightest-blue">
                    <th class="tl ph2">{{ user.id|e }}</th>
                    <td class="pv3 tc">{{ user.username|e }}</td>
                    <td class="pv3 tc">{{ user.email|e }}</td>
                    <td class="pv3 tc">{{ user.role|e }}</td>
                    <td class="flex flex-column flex-row-l tc-m w-100">
            
                    {% if user.role == 'admin' %}
                        <a href="/admin/users/upgrade?id={{ user.id|e }}"
                            class="link br2 ba b--dark-green bg-green white pa2 ml1 mv1 bg-animate hover-bg-dark-green border-box center">Passer Abonné
                        </a>
                    {% endif %}
                    {% if user.role == 'subscriber' %}
                        <a href="/admin/users/upgrade?id={{ user.id|e }}"
                            class="link br2 ba b--dark-green bg-green white pa2 ml1 mv1 bg-animate hover-bg-dark-green border-box center">Passer Administrateur
                        </a>
                    {% endif %}
            
                        <a href="/admin/users/delete?id={{ user.id|e }}"
                            class="link br2 ba b--dark-red bg-red white pa2 ml1 mv1 bg-animate hover-bg-dark-red border-box ">Supprimer
                        </a>
                    </td>
                </tr>
            {% endfor %} 
            </tbody>
        </table>
         {% if session.get('delete_user') %}
            <div class="mt3 flex items-center justify-center pa4 bg-light-green ">
                <span class="i"> {{ session.show('delete_user') }}</span>
            </div>
        {% endif %}
         {% if session.get('error_delete_user') %}
            <div class="mt3 flex items-center justify-center pa4 bg-light-red ">
                <span class="i"> {{ session.show('error_delete_user') }}</span>
            </div>
        {% endif %}
         {% if session.get('upgrade_user') %}
            <div class="mt3 flex items-center justify-center pa4 bg-light-green ">
                <span class="i"> {{ session.show('upgrade_user') }}</span>
            </div>
        {% endif %}
         {% if session.get('error_upgrade_user') %}
            <div class="mt3 flex items-center justify-center pa4 bg-light-red ">
                <span class="i"> {{ session.show('error_upgrade_user') }}</span>
            </div>
        {% endif %}
    </section>
</main>

{% endblock %}